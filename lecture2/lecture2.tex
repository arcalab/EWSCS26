% !TeX program = xelatex
\documentclass{beamer}
\usepackage{etex} % fixes new-dimension error
%-------------- template --------------------------------------------------
\usetheme{metropolis}
\metroset{block=fill}
%\usetheme{Boadilla}

% Configuring the foot line
\setbeamertemplate{footline}
{
  \leavevmode%
  \hbox{%
  \begin{beamercolorbox}[wd=.4\paperwidth,ht=2.25ex,dp=1ex,center]{author in head/foot}%
    \usebeamerfont{author in head/foot}\insertshortauthor
  \end{beamercolorbox}%
  \begin{beamercolorbox}[wd=.5\paperwidth,ht=2.25ex,dp=1ex,center]{title in head/foot}%
    \usebeamerfont{title in head/foot}\insertsection
  \end{beamercolorbox}%
  \begin{beamercolorbox}[wd=.1\paperwidth,ht=2.25ex,dp=1ex,right]{date in head/foot}%
    \insertframenumber{} / \inserttotalframenumber\hspace*{2ex} 
  \end{beamercolorbox}}%
  \vskip0pt%
}
% No configuration symbols
\makeatother
\setbeamertemplate{navigation symbols}{}
%----------------------------------------------------------------------------
\usepackage{graphicx,amsmath}
\usepackage{stmaryrd} % cf. interleave
\usepackage{booktabs}
\usepackage{amscd}
\usepackage{multicol}
\usepackage[absolute,overlay]{textpos}
\usepackage{alltt}
\usepackage{proof}
\usepackage{subcaption}
\usepackage{tikz}
\usepackage{tikz-cd}
\usepackage[new]{old-arrows}
\usepackage[all]{xy}
\usepackage{pgfplots}
\usepackage{textcomp}
\usepackage{listings}
\usetikzlibrary{arrows.meta, calc, fit, tikzmark}

\AtBeginSection[]
{
    \begin{frame}
        \frametitle{Table of Contents}
        \tableofcontents[currentsection]
    \end{frame}
}
\author[Renato Neves]{Renato Neves}

% logos of institutions
\titlegraphic{
  \begin{textblock*}{5cm}(7.8cm,7.45cm)
     \includegraphics[scale=0.044]{../images/uminho.png}\hspace*{.85cm}~%
  \end{textblock*}
  \begin{textblock*}{5cm}(9.8cm,7.45cm)
    \includegraphics[scale=0.4]{../images/haslab.pdf}
  \end{textblock*}
}

% code
\lstset{
showstringspaces=false,
keywordstyle=\color{blue},
basicstyle=\fontsize{08.5}{10}\ttfamily,
emph={while,do,if,diff,for,exit,blue,unif,then,else,wait,bernoulli,exp,normal,sqrt,cos,';'},emphstyle=\color{blue},
breaklines=true,
escapeinside={*@}{*@}
}

\input{macros}


% No date
\date{}


\begin{document}

\title{Lecture 2}

\frame[plain]{\titlepage}

\section{Overview}

\begin{frame}{Today}
        The bare essentials of category theory


        \medskip
        Useful for providing a semantics to our calculus
\end{frame}

\begin{frame}{Why semantics?}

        Links the calculus to well-known mathematical models
                
        \medskip
        Also useful for obtaining new insights about the calculus
\end{frame}

\section{Category Theory}

\begin{frame}{Category theory in a nutshell}

        The mathematics of mathematics

        \medskip
        A way of proving results once and for all

        \medskip
        \dots
\end{frame}

\begin{frame}{A category}

        Consists of a collection of things (aka \alert{objects}) $A,B,C$ \dots

        \medskip
        and arrows (aka \alert{morphisms}) $f : A \to B$ connecting these things

        \pause
        \bigskip
        There is an \alert{identity} arrow $\id : A \to A$ for each $A$

        \pause
        \bigskip
        Arrows are \alert{composable} ie
        \[
                \infer{
                        g \comp f : A \to C
                }{
                        f : A \to B \qquad g : B \to C}
        \]
        \pause
        (composition is associative and has $\id$ as neutral element)
\end{frame}

\begin{frame}{Examples}
        \begin{itemize}
                \item Sets and functions ($\Set$) \\[10pt]
                \item Vector spaces and linear functions ($\CVec$) \\[10pt]
                \item Metric spaces and non-expansive functions ($\Met$) \\[10pt]
                \item Reals numbers and the $\leq$ relation ($\CR$)  \\[10pt]
                \item $\Nats$-indexed metric spaces and $\Nats$-indexed maps
                        $([\Nats,\Met])$
        \end{itemize}

        \pause
        \vfill
        \begin{block}{Exercise}
                Show that all these are indeed examples of a category 
        \end{block}
\end{frame}

\begin{frame}{A symmetric monoidal category}

        A monoidal category allows
        \begin{itemize}
                \item \alert{pairing} two objs. $A$ and $B$ into a single one $A
                        \otimes B$ 
                \item and analogously for morphisms, ie
                        \[
                                \infer{
                                        f \otimes g : A \otimes B \to A' \otimes B'
                                }{
                                        f : A \to A' \qquad g : B \to B'
                                }
                        \]
                \item It has an obj. $I$ such that $i : I \otimes A \stackrel{\cong}{\to} A$ for
                        every obj. $A$
        \end{itemize}

        {\scriptsize (of course a number of coherence laws also need to hold)}

        \bigskip
        There is also a \alert{symmetry} morphism $\mathrm{sw} : A \otimes B
        \stackrel{\cong}{\to} B \otimes A$
\end{frame}

\begin{frame}{Examples}

        All previous examples of a category are also symm. monoidal

        \bigskip
        \begin{block}{Exercise}
                Show that such is indeed the case 
        \end{block}
\end{frame}

\begin{frame}{A symmetric monoidal closed category}

        For every pair of objects $A$ and $B$ we 
        have an object $A \multimap B$

        \pause
        \dots\ s.t. the following diagram commutes
        for a \alert{unique} $\lambda f$

        \[
               \xymatrix@C=50pt{
                       A \otimes B \ar[dr]^{f} 
                       \ar@{->}[d]_{(\lambda f) \otimes \id}
                       \\
                       (A \multimap B) \otimes B \ar[r]_(0.55){\mathrm{app}} & C
               }
        \]

        \pause
\end{frame}

\begin{frame}{Examples}

        All previous examples are also symm. monoidal closed

        \bigskip
        \begin{block}{Exercise}
                Show that such is indeed the case 
        \end{block}
\end{frame}


\section{Categorical semantics of linear lambda-calculus}

\begin{frame}{Categorical semantics of linear lambda-calculus}

        Any smc category gives semantics to linear $\lambda$-calculus

        \medskip
        Types interpreted as objects

        \medskip
        Terms interpreted as morphisms
\end{frame}

\begin{frame}{The semantics}

  Types $\typeA$ interpreted as objects
  \begin{flalign*}
    \sem{\typeI} & = I \\
    \sem{\typeA \otimes \typeB} & = \sem{\typeA} \otimes \sem{\typeB} \\
    \sem{\typeA \multimap \typeB} & = \sem{\typeA} \multimap\sem{\typeB}
 \end{flalign*}

 Typing contexts $\Gamma$ interpreted as tensor products
 \begin{flalign*}
  \sem{\Gamma}\ = \sem{x_1 : \typeA_1, \dots, x_n : \typeA_n}\ =
 \sem{\typeA_1}\ \otimes \dots \otimes \sem{\typeA_n} 
 \end{flalign*}

 Terms $\Gamma \vljud t : \typeA$ interpreted as morphisms
 \begin{flalign*}
   \sem{\Gamma \vljud t : \typeA}\ : \sem{\Gamma}\ \longrightarrow \sem{\typeA}
 \end{flalign*}

\end{frame}

\begin{frame}{The semantics}
  \small{
  \begin{flalign*}
      \hspace{-0.2cm}
      \infer[]{\sem{x : \typeA \vljud x : \typeA} = \id}{} \hspace{1cm}
      \infer[]{\sem{(-) \vljud  \ast : \typeI} = \id}{} 
  \end{flalign*}
  \begin{flalign*}
      \hspace{-0.2cm}
      \infer{\sem{\Gamma,\Delta \vljud t \text{ to } \ast.\  \, s: \typeA}\ = i \comp (f \otimes g)}{
              \sem{\Gamma \vljud t : \typeI}\ = f \qquad
              \sem{\Delta \vljud s : \typeA}\ = g
      }
      \hspace{1cm}
      \infer[]{\sem{\Gamma,\Delta \vljud t \otimes s : \typeA \otimes \typeB}\ = f \otimes g}
      {\sem{\Gamma \vljud t : \typeA}\ = f 
      \qquad \sem{\Delta \vljud s: \typeB}\ = g
      }
  \end{flalign*}
  \begin{flalign*}
      \infer{
              \sem{\Gamma, \Delta \vljud 
              \text{pm } t \text{ to } x \otimes y.\, s: \typeC}\ = 
              g \comp \mathrm{sw} \comp (f \otimes \id)
      }{
              \sem{\Gamma \vljud t : \typeA \otimes \typeB}\ = f
              \qquad
              \sem{\Delta, x: \typeA, y: \typeB \vljud s: \typeC}\ = g
      }
  \end{flalign*}
  \begin{flalign*}
      \hspace{-0.2cm}
      \infer[]{\sem{\Gamma \vljud \lambda x : \typeA.\ t : \typeA \multimap \typeB}\ = \lambda f}
      {
              \sem{\Gamma, x: \typeA \vljud t : \typeB}\ = f
      }
      \hspace{1cm}
      \infer[]{
              \sem{\Gamma,\Delta \vljud t \, s : \typeB}\ = \mathrm{app} \comp (f \otimes g)
      }
      {
              \sem{\Gamma \vljud t: \typeA \multimap \typeB}\ = f  \quad
              \sem{\Delta \vljud s:  \typeA}\ = g }
  \end{flalign*}
        } 
  
      \begin{center}
              {\scriptsize (Semantics slightly oversimplified)}
      \end{center}

\end{frame}

\begin{frame}{The different incarnations of swap}
        \[
                \sem{(-) \vdash \lambda x. \> \text{pm } x \text{ to } x_1 \otimes x_2. 
                \> x_2 \otimes x_1 }
        \]

        \begin{align*}
                (v,u) \mapsto (u,v) & \hspace{1cm} \text{ in } \Set 
                \\[10pt]
                v \otimes u \mapsto u \otimes v & \hspace{1cm} \text{ in } \CVec
                \\[10pt]
                0 \leq (b + a) - (a + b) & \hspace{1cm} \text{ in } \CR
                \\[10pt]
                \begin{cases}
                        n \not = 0 \mapsto \text{undefined}
                        \\
                        n = 0 \mapsto (v,u) \mapsto (u,v)
                \end{cases}
                & \hspace{1cm} \text{ in } [\Nats, \Met]
        \end{align*}
\end{frame}

\begin{frame}{Soundness}

        If $t = s$ then $\sem{t} = \sem{s}$ in any smc category

        \medskip
        Proof: show that each equation in the eq. system is sound 

        \medskip
        Enables eq. reasoning across all smc categories at once
\end{frame}

\begin{frame}{Soundness}
        Enables eq. reasoning across all smc categories at once

        \medskip
        \begin{block}{Example}
                $\lambda(app) = \id$ translates to
                \[
                        f : \typeA \multimap \typeB \vdash \lambda x. \, f \, x = f : \typeA \multimap \typeB
                \]
        \end{block}
\end{frame}
\end{document}
